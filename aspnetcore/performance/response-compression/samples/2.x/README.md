# <a name="response-compression-sample-application-aspnet-core-2x"></a><span data-ttu-id="7a057-101">Réponse compression exemple d’application (ASP.NET Core 2.x)</span><span class="sxs-lookup"><span data-stu-id="7a057-101">Response compression sample application (ASP.NET Core 2.x)</span></span>

<span data-ttu-id="7a057-102">Cet exemple illustre l’utilisation d’ASP.NET Core 2.x intergiciel de Compression des réponses pour compresser les réponses HTTP.</span><span class="sxs-lookup"><span data-stu-id="7a057-102">This sample illustrates the use of ASP.NET Core 2.x Response Compression Middleware to compress HTTP responses.</span></span> <span data-ttu-id="7a057-103">L’exemple montre comment Gzip, Brotli et fournisseurs de compression personnalisé pour les réponses de type text et image et montre comment ajouter un type MIME pour la compression.</span><span class="sxs-lookup"><span data-stu-id="7a057-103">The sample demonstrates Gzip, Brotli, and custom compression providers for text and image responses and shows how to add a MIME type for compression.</span></span> <span data-ttu-id="7a057-104">Pour obtenir l’exemple ASP.NET Core 1.x, consultez [réponse compression exemple d’application (ASP.NET Core 1.x)](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/performance/response-compression/samples/1.x).</span><span class="sxs-lookup"><span data-stu-id="7a057-104">For the ASP.NET Core 1.x sample, see [Response compression sample application (ASP.NET Core 1.x)](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/performance/response-compression/samples/1.x).</span></span>

## <a name="examples-in-this-sample"></a><span data-ttu-id="7a057-105">Extraits de cet exemple</span><span class="sxs-lookup"><span data-stu-id="7a057-105">Examples in this sample</span></span>

* `BrotliCompressionProvider`
  * `text/plain`
    * <span data-ttu-id="7a057-106">**/** -Lorem Ipsum fichier réponse à octets 2,044 qui compresse à ~ 979 octets.</span><span class="sxs-lookup"><span data-stu-id="7a057-106">**/** - Lorem Ipsum text file response at 2,044 bytes that compresses to ~979 bytes.</span></span>
    * <span data-ttu-id="7a057-107">**/testfile1kb.txt** -réponse de fichier texte à octets 1,033 qui compresse à environ 36 octets.</span><span class="sxs-lookup"><span data-stu-id="7a057-107">**/testfile1kb.txt** - Text file response at 1,033 bytes that compresses to ~36 bytes.</span></span>
    * <span data-ttu-id="7a057-108">**/ segmentée** -réponse émis en tant que caractères uniques à intervalles de 1 seconde.</span><span class="sxs-lookup"><span data-stu-id="7a057-108">**/trickle** - Response issued as single characters at 1 second intervals.</span></span>
* `GzipCompressionProvider`
  * `text/plain`
    * <span data-ttu-id="7a057-109">**/** -Lorem Ipsum fichier réponse à octets 2,044 qui compresse à ~ 927 octets.</span><span class="sxs-lookup"><span data-stu-id="7a057-109">**/** - Lorem Ipsum text file response at 2,044 bytes that compresses to ~927 bytes.</span></span>
    * <span data-ttu-id="7a057-110">**/testfile1kb.txt** -réponse de fichier texte à octets 1,033 qui compresse à environ 47 octets.</span><span class="sxs-lookup"><span data-stu-id="7a057-110">**/testfile1kb.txt** - Text file response at 1,033 bytes that compresses to ~47 bytes.</span></span>
    * <span data-ttu-id="7a057-111">**/ segmentée** -réponse émis en tant que caractères uniques à intervalles de 1 seconde.</span><span class="sxs-lookup"><span data-stu-id="7a057-111">**/trickle** - Response issued as single characters at 1 second intervals.</span></span>
  * `image/svg+xml`
    * <span data-ttu-id="7a057-112">**/Banner.SVG** -un graphique SVG (Scalable Vector) image en réponse à des octets 9,707 qui compresse à ~ 4,459 octets.</span><span class="sxs-lookup"><span data-stu-id="7a057-112">**/banner.svg** - A Scalable Vector Graphics (SVG) image response at 9,707 bytes that compresses to ~4,459 bytes.</span></span>
* `CustomCompressionProvider`<br><span data-ttu-id="7a057-113">Montre comment implémenter un fournisseur de compression personnalisé pour une utilisation avec l’intergiciel (middleware).</span><span class="sxs-lookup"><span data-stu-id="7a057-113">Shows how to implement a custom compression provider for use with the middleware.</span></span>

<span data-ttu-id="7a057-114">Lorsque la demande inclut le `Accept-Encoding` la compression d’en-tête et de réponse est réussie, l’intergiciel (middleware) ajoute automatiquement un `Vary: Accept-Encoding` en-tête à la réponse.</span><span class="sxs-lookup"><span data-stu-id="7a057-114">When the request includes the `Accept-Encoding` header and response compression is successful, the middleware automatically adds a `Vary: Accept-Encoding` header to the response.</span></span> <span data-ttu-id="7a057-115">Le `Vary` caches à maintenir plusieurs copies de la réponse en fonction des valeurs alternatives de demande à l’en-tête `Accept-Encoding`, afin que les deux un compressé (Gzip ou Brotli) et de la version non compressée sont stockés dans les caches pour les systèmes qui peuvent accepter le compressé ou la réponse non compressée.</span><span class="sxs-lookup"><span data-stu-id="7a057-115">The `Vary` header instructs caches to maintain multiple copies of the response based on alternative values of `Accept-Encoding`, so both a compressed (Gzip or Brotli) and uncompressed version are stored in caches for systems that can either accept the compressed or the uncompressed response.</span></span>

## <a name="use-the-sample"></a><span data-ttu-id="7a057-116">Utilisez l’exemple</span><span class="sxs-lookup"><span data-stu-id="7a057-116">Use the sample</span></span>

1. <span data-ttu-id="7a057-117">Effectuer une demande à l’aide [Fiddler](https://www.telerik.com/fiddler), [Firebug](https://getfirebug.com/), ou [Postman](https://www.getpostman.com/) à l’application sans un `Accept-Encoding` en-tête et notez la charge utile de réponse, la taille de la réponse, et en-têtes de réponse.</span><span class="sxs-lookup"><span data-stu-id="7a057-117">Make a request using [Fiddler](https://www.telerik.com/fiddler), [Firebug](https://getfirebug.com/), or [Postman](https://www.getpostman.com/) to the application without an `Accept-Encoding` header and note the response payload, response size, and response headers.</span></span>
1. <span data-ttu-id="7a057-118">Ajouter un `Accept-Encoding: br` ou `Accept-Encoding: gzip` en-tête et notez la taille de la réponse compressée et les en-têtes de réponse.</span><span class="sxs-lookup"><span data-stu-id="7a057-118">Add an `Accept-Encoding: br` or `Accept-Encoding: gzip` header and note the compressed response size and response headers.</span></span> <span data-ttu-id="7a057-119">Supprime de la taille de la réponse et le `Content-Encoding` en-tête de réponse est inclus par l’intergiciel (middleware) qui indique que la compression avec soit Gzip ou Brotli s’est produite.</span><span class="sxs-lookup"><span data-stu-id="7a057-119">The response size drops, and the `Content-Encoding` response header is included by the middleware indicating that compression with either Gzip or Brotli occurred.</span></span> <span data-ttu-id="7a057-120">Lorsque vous examinez le corps de réponse pour le Lorem Ipsum ou **testfile1kb.txt** réponse, vous voyez que le texte est compressé et illisible.</span><span class="sxs-lookup"><span data-stu-id="7a057-120">When you look at the response body for the Lorem Ipsum or **testfile1kb.txt** response, you see that the text is compressed and unreadable.</span></span>
1. <span data-ttu-id="7a057-121">Ajouter un `Accept-Encoding: mycustomcompression` en-tête et notez les en-têtes de réponse.</span><span class="sxs-lookup"><span data-stu-id="7a057-121">Add an `Accept-Encoding: mycustomcompression` header and note the response headers.</span></span> <span data-ttu-id="7a057-122">Le `CustomCompressionProvider` est une implémentation vide qui ne compresser réellement la réponse, mais vous pouvez créer un wrapper de flux de compression personnalisé pour le `CreateStream()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="7a057-122">The `CustomCompressionProvider` is an empty implementation that doesn't actually compress the response, but you can create a custom compression stream wrapper for the `CreateStream()` method.</span></span>
