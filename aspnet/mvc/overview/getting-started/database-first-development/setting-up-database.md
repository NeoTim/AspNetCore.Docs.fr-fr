---
uid: mvc/overview/getting-started/database-first-development/setting-up-database
title: 'Tutoriel : Bien démarrer avec Entity Framework Database First avec MVC 5'
description: Ce didacticiel montre comment commencer avec un existant de base de données et de créer rapidement une application web qui permet aux utilisateurs d’interagir avec les données.
author: Rick-Anderson
ms.author: riande
ms.date: 01/28/2019
ms.topic: tutorial
ms.assetid: 095abad4-3bfe-4f06-b092-ae6a735b7e49
msc.legacyurl: /mvc/overview/getting-started/database-first-development/setting-up-database
msc.type: authoredcontent
ms.openlocfilehash: dfc6c7a7083524a1e7049fdc879fe679f951084d
ms.sourcegitcommit: ed76cc752966c604a795fbc56d5a71d16ded0b58
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/02/2019
ms.locfileid: "55667737"
---
# <a name="tutorial-get-started-with-ef-database-first-using-mvc-5"></a><span data-ttu-id="3a3b1-103">Tutoriel : Bien démarrer avec Entity Framework Database First avec MVC 5</span><span class="sxs-lookup"><span data-stu-id="3a3b1-103">Tutorial: Get started with EF Database First using MVC 5</span></span>

<span data-ttu-id="3a3b1-104">À l’aide de la structure ASP.NET MVC et Entity Framework, vous pouvez créer une application web qui fournit une interface à une base de données existante.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-104">Using MVC, Entity Framework, and ASP.NET Scaffolding, you can create a web application that provides an interface to an existing database.</span></span> <span data-ttu-id="3a3b1-105">Cette série de didacticiels vous montre comment générer du code qui permet aux utilisateurs d’afficher, modifier, créer et supprimer automatiquement les données qui résident dans une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-105">This tutorial series shows you how to automatically generate code that enables users to display, edit, create, and delete data that resides in a database table.</span></span> <span data-ttu-id="3a3b1-106">Le code généré correspond aux colonnes dans la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-106">The generated code corresponds to the columns in the database table.</span></span> <span data-ttu-id="3a3b1-107">Dans la dernière partie de la série, vous allez découvrir comment ajouter des annotations de données au modèle de données pour spécifier les exigences de validation et afficher la mise en forme.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-107">In the last part of the series, you learn how add data annotations to the data model to specify validation requirements and display formatting.</span></span> <span data-ttu-id="3a3b1-108">Lorsque vous avez terminé, vous pouvez passer à un article pour savoir comment déployer une application .NET et la base de données SQL dans Azure App Service sur Azure.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-108">When you're done, you can advance to an Azure article to learn how to deploy a .NET app and SQL database to Azure App Service.</span></span>

<span data-ttu-id="3a3b1-109">Ce didacticiel montre comment commencer avec un existant de base de données et de créer rapidement une application web qui permet aux utilisateurs d’interagir avec les données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-109">This tutorial shows how to start with an existing database and quickly create a web application that enables users to interact with the data.</span></span> <span data-ttu-id="3a3b1-110">Il utilise l’Entity Framework 6 et MVC 5 pour générer l’application web.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-110">It uses the Entity Framework 6 and MVC 5 to build the web application.</span></span> <span data-ttu-id="3a3b1-111">La fonctionnalité de génération de modèles automatique ASP.NET vous permet de générer automatiquement le code pour l’affichage, la mise à jour, la création et la suppression de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-111">The ASP.NET Scaffolding feature enables you to automatically generate code for displaying, updating, creating and deleting data.</span></span> <span data-ttu-id="3a3b1-112">Utilisez les outils de publication dans Visual Studio, vous pouvez facilement déployer le site et la base de données vers Azure.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-112">Using the publishing tools within Visual Studio, you can easily deploy the site and database to Azure.</span></span>

<span data-ttu-id="3a3b1-113">Cette partie de la série se concentre sur la création d’une base de données et le remplir avec des données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-113">This part of the series focuses on creating a database and populating it with data.</span></span>

<span data-ttu-id="3a3b1-114">Cette série a été écrit avec les contributions de Tom Dykstra et Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-114">This series was written with contributions from Tom Dykstra and Rick Anderson.</span></span> <span data-ttu-id="3a3b1-115">Il a été amélioré en se basant sur les commentaires des utilisateurs dans la section commentaires.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-115">It was improved based on feedback from users in the comments section.</span></span>

<span data-ttu-id="3a3b1-116">Dans ce didacticiel, vous avez effectué les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="3a3b1-116">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="3a3b1-117">Configurer la base de données</span><span class="sxs-lookup"><span data-stu-id="3a3b1-117">Set up the database</span></span>

## <a name="prerequisites"></a><span data-ttu-id="3a3b1-118">Prérequis</span><span class="sxs-lookup"><span data-stu-id="3a3b1-118">Prerequisites</span></span>

* [<span data-ttu-id="3a3b1-119">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="3a3b1-119">Visual Studio 2017</span></span>](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

## <a name="introduction"></a><span data-ttu-id="3a3b1-120">Introduction</span><span class="sxs-lookup"><span data-stu-id="3a3b1-120">Introduction</span></span>

<span data-ttu-id="3a3b1-121">Ce didacticiel traite de la situation où vous avez une base de données et que vous voulez générer du code pour une application web basée sur les champs de cette base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-121">This tutorial addresses the situation where you have a database and want to generate code for a web application based on the fields of that database.</span></span> <span data-ttu-id="3a3b1-122">Cette approche est appelée développement Database First.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-122">This approach is called Database First development.</span></span> <span data-ttu-id="3a3b1-123">Si vous ne disposez pas d’une base de données existante, vous pouvez utiliser à la place une approche de développement Code First qui implique la définition des classes de données et la génération de la base de données à partir des propriétés de classe.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-123">If you do not already have an existing database, you can instead use an approach called Code First development which involves defining data classes and generating the database from the class properties.</span></span>

## <a name="set-up-the-database"></a><span data-ttu-id="3a3b1-124">Configurer la base de données</span><span class="sxs-lookup"><span data-stu-id="3a3b1-124">Set up the database</span></span>

<span data-ttu-id="3a3b1-125">Pour reproduire l’environnement d’avoir une base de données existante, vous serez tout d’abord créer une base de données avec des données préremplies et puis créer votre application web qui se connecte à la base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-125">To mimic the environment of having an existing database, you will first create a database with some pre-filled data, and then create your web application that connects to the database.</span></span>

<span data-ttu-id="3a3b1-126">Ce didacticiel a été développé à l’aide de la base de données locale.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-126">This tutorial was developed using LocalDB.</span></span> <span data-ttu-id="3a3b1-127">Vous pouvez utiliser un serveur de base de données existant au lieu de la base de données locale, mais selon votre version de Visual Studio et votre type de base de données, tous les outils de données dans Visual Studio ne peuvent pas être pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-127">You can use an existing database server instead of LocalDB, but depending on your version of Visual Studio and your type of database, all of the data tools in Visual Studio might not be supported.</span></span> <span data-ttu-id="3a3b1-128">Si les outils ne sont pas disponibles pour votre base de données, vous devrez peut-être effectuer certaines des étapes spécifiques à la base de données au sein de la suite de gestion pour votre base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-128">If the tools are not available for your database, you may need to perform some of the database-specific steps within the management suite for your database.</span></span>

<span data-ttu-id="3a3b1-129">Si vous avez un problème avec les outils de base de données dans votre version de Visual Studio, assurez-vous que vous avez installé la dernière version des outils de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-129">If you have a problem with the database tools in your version of Visual Studio, make sure you have installed the latest version of the database tools.</span></span> <span data-ttu-id="3a3b1-130">Pour plus d’informations sur la mise à jour ou installation des outils de base de données, consultez [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-130">For information about updating or installing the database tools, see [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span></span>

<span data-ttu-id="3a3b1-131">Lancez Visual Studio et créez un **projet de base de données SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-131">Launch Visual Studio and create a **SQL Server Database Project**.</span></span> <span data-ttu-id="3a3b1-132">Nommez le projet **ContosoUniversityData**.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-132">Name the project **ContosoUniversityData**.</span></span>

![créer le projet de base de données](setting-up-database/_static/image1.png)

<span data-ttu-id="3a3b1-134">Vous disposez maintenant d’un projet de base de données vide.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-134">You now have an empty database project.</span></span> <span data-ttu-id="3a3b1-135">Pour vous assurer que vous pouvez déployer cette base de données vers Azure, vous allez définir la base de données SQL Azure en tant que la plateforme cible pour le projet.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-135">To make sure that you can deploy this database to Azure, you'll set Azure SQL Database as the target platform for the project.</span></span> <span data-ttu-id="3a3b1-136">Définition de la plateforme cible ne déploie pas réellement la base de données ; Cela signifie simplement que le projet de base de données doit vérifier que la conception de base de données est compatible avec la plateforme cible.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-136">Setting the target platform does not actually deploy the database; it only means that the database project will verify that the database design is compatible with the target platform.</span></span> <span data-ttu-id="3a3b1-137">Pour définir la plateforme cible, ouvrez le **propriétés** pour le projet, puis sélectionnez **Microsoft Azure SQL Database** pour la plateforme cible.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-137">To set the target platform, open the **Properties** for the project and select **Microsoft Azure SQL Database** for the target platform.</span></span>

<span data-ttu-id="3a3b1-138">Vous pouvez créer les tables nécessaires pour ce didacticiel en ajoutant les scripts SQL qui définissent les tables.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-138">You can create the tables needed for this tutorial by adding SQL scripts that define the tables.</span></span> <span data-ttu-id="3a3b1-139">Cliquez sur votre projet et ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-139">Right-click your project and add a new item.</span></span> <span data-ttu-id="3a3b1-140">Sélectionnez **Tables et vues** > **Table** et nommez-le *étudiant*.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-140">Select **Tables and Views** > **Table** and name it *Student*.</span></span>

<span data-ttu-id="3a3b1-141">Dans le fichier de la table, remplacez la commande T-SQL avec le code suivant pour créer la table.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-141">In the table file, replace the T-SQL command with the following code to create the table.</span></span>

[!code-sql[Main](setting-up-database/samples/sample1.sql)]

<span data-ttu-id="3a3b1-142">Notez que la fenêtre de conception se synchronise automatiquement avec le code.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-142">Notice that the design window automatically synchronizes with the code.</span></span> <span data-ttu-id="3a3b1-143">Vous pouvez travailler avec le code ou le concepteur.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-143">You can work with either the code or designer.</span></span>

![afficher le code et conception](setting-up-database/_static/image5.png)

<span data-ttu-id="3a3b1-145">Ajouter une autre table.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-145">Add another table.</span></span> <span data-ttu-id="3a3b1-146">Cette fois, nommez-le cours et utilisez la commande T-SQL suivante.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-146">This time name it Course and use the following T-SQL command.</span></span>

[!code-sql[Main](setting-up-database/samples/sample2.sql)]

<span data-ttu-id="3a3b1-147">Et bien, répétez le plus de temps pour créer une table nommée d’inscription.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-147">And, repeat one more time to create a table named Enrollment.</span></span>

[!code-sql[Main](setting-up-database/samples/sample3.sql)]

<span data-ttu-id="3a3b1-148">Vous pouvez remplir votre base de données via un script qui est exécuté une fois que la base de données est déployée.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-148">You can populate your database with data through a script that is run after the database is deployed.</span></span> <span data-ttu-id="3a3b1-149">Ajouter un Script de post-déploiement pour le projet.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-149">Add a Post-Deployment Script to the project.</span></span> <span data-ttu-id="3a3b1-150">Cliquez sur votre projet et ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-150">Right-click your project and add a new item.</span></span> <span data-ttu-id="3a3b1-151">Sélectionnez **Scripts utilisateur** > **Script de post-déploiement**.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-151">Select **User Scripts** > **Post-Deployment Script**.</span></span> <span data-ttu-id="3a3b1-152">Vous pouvez utiliser le nom par défaut.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-152">You can use the default name.</span></span>

<span data-ttu-id="3a3b1-153">Ajoutez le code T-SQL suivant pour le script de post-déploiement.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-153">Add the following T-SQL code to the post-deployment script.</span></span> <span data-ttu-id="3a3b1-154">Ce script ajoute simplement les données à la base de données lorsqu’aucun enregistrement correspondant n’est trouvé.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-154">This script simply adds data to the database when no matching record is found.</span></span> <span data-ttu-id="3a3b1-155">Il ne pas remplacer ou supprimer des données que vous avez entré dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-155">It does not overwrite or delete any data you may have entered into the database.</span></span>

[!code-sql[Main](setting-up-database/samples/sample4.sql)]

<span data-ttu-id="3a3b1-156">Il est important de noter que le script de post-déploiement est exécuté chaque fois que vous déployez votre projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-156">It is important to note that the post-deployment script is run every time you deploy your database project.</span></span> <span data-ttu-id="3a3b1-157">Par conséquent, vous devez soigneusement vos besoins lors de l’écriture de ce script.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-157">Therefore, you need to carefully consider your requirements when writing this script.</span></span> <span data-ttu-id="3a3b1-158">Dans certains cas, vous pouvez recommencer à partir d’un ensemble connu de données chaque fois que le projet est déployé.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-158">In some cases, you may wish to start over from a known set of data every time the project is deployed.</span></span> <span data-ttu-id="3a3b1-159">Dans d’autres cas, vous souhaiterez pas modifier les données existantes en aucune façon.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-159">In other cases, you may not want to alter the existing data in any way.</span></span> <span data-ttu-id="3a3b1-160">Selon vos besoins, vous pouvez décider si vous avez besoin d’un script de post-déploiement ou ce que vous devez inclure dans le script.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-160">Based on your requirements, you can decide whether you need a post-deployment script or what you need to include in the script.</span></span> <span data-ttu-id="3a3b1-161">Pour plus d’informations sur le remplissage de votre base de données avec un script de post-déploiement, consultez [, y compris les données dans un projet de base de données SQL Server](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-161">For more information about populating your database with a post-deployment script, see [Including Data in a SQL Server Database Project](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span></span>

<span data-ttu-id="3a3b1-162">Vous disposez maintenant des fichiers de script SQL 4, mais aucune table réelle.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-162">You now have 4 SQL script files but no actual tables.</span></span> <span data-ttu-id="3a3b1-163">Vous êtes prêt à déployer votre projet de base de données à la base de données locale.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-163">You are ready to deploy your database project to localdb.</span></span> <span data-ttu-id="3a3b1-164">Dans Visual Studio, cliquez sur le bouton Démarrer (ou F5) pour générer et déployer votre projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-164">In Visual Studio, click the Start button (or F5) to build and deploy your database project.</span></span> <span data-ttu-id="3a3b1-165">Vérifier le **sortie** onglet pour vérifier que la génération et le déploiement a réussi.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-165">Check the **Output** tab to verify that the build and deployment succeeded.</span></span>

<span data-ttu-id="3a3b1-166">Pour voir que la nouvelle base de données a été créée, ouvrez **Explorateur d’objets SQL Server** et recherchez le nom du projet dans le serveur de base de données locale appropriée (dans ce cas **(localdb) \ProjectsV13**).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-166">To see that the new database has been created, open **SQL Server Object Explorer** and look for the name of the project in the correct local database server (in this case **(localdb)\ProjectsV13**).</span></span>

<span data-ttu-id="3a3b1-167">Pour voir que les tables sont remplies avec les données, cliquez sur une table, puis sélectionnez **afficher les données**.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-167">To see that the tables are populated with data, right-click a table, and select **View Data**.</span></span>

![afficher les données de table](setting-up-database/_static/image9.png)

<span data-ttu-id="3a3b1-169">Une vue modifiable des données de la table s’affiche.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-169">An editable view of the table data is displayed.</span></span> <span data-ttu-id="3a3b1-170">Par exemple, si vous sélectionnez **Tables** > **dbo.course** > **afficher les données**, vous voyez une table avec trois colonnes (**cours**, **Titre**, et **crédits**) et quatre lignes.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-170">For example, if you select **Tables** > **dbo.course** > **View Data**, you see a table with three columns (**Course**, **Title**, and **Credits**) and four rows.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3a3b1-171">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3a3b1-171">Additional resources</span></span>

<span data-ttu-id="3a3b1-172">Pour obtenir un exemple d’introduction du développement Code First, consultez [mise en route avec ASP.NET MVC 5](../introduction/getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-172">For an introductory example of Code First development, see [Getting Started with ASP.NET MVC 5](../introduction/getting-started.md).</span></span> <span data-ttu-id="3a3b1-173">Pour un exemple plus avancé, consultez [création d’un modèle de données Entity Framework pour une application ASP.NET MVC 4](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-173">For a more advanced example, see [Creating an Entity Framework Data Model for an ASP.NET MVC 4 App](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="3a3b1-174">Pour obtenir des conseils sur la sélection de l’approche Entity Framework à utiliser, consultez [approches de développement Entity Framework](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span><span class="sxs-lookup"><span data-stu-id="3a3b1-174">For guidance on selecting which Entity Framework approach to use, see [Entity Framework Development Approaches](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a3b1-175">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="3a3b1-175">Next steps</span></span>

<span data-ttu-id="3a3b1-176">Dans ce didacticiel, vous avez effectué les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="3a3b1-176">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="3a3b1-177">Configurer la base de données</span><span class="sxs-lookup"><span data-stu-id="3a3b1-177">Set up the database</span></span>

<span data-ttu-id="3a3b1-178">Passez au didacticiel suivant pour apprendre à créer des modèles d’application et les données du web.</span><span class="sxs-lookup"><span data-stu-id="3a3b1-178">Advance to the next tutorial to learn how to create the web application and data models.</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="3a3b1-179">Créer des modèles d’application et les données du web</span><span class="sxs-lookup"><span data-stu-id="3a3b1-179">Create the web application and data models</span></span>](creating-the-web-application.md)
